<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>我的课程 | IMedlib</title>

    <link href="../../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../bower_components/font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="../../css/animate.css" rel="stylesheet">
    <link href="../../css/style.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../../bower_components/sweetalert/dist/sweetalert.css">
    <link rel="stylesheet" type="text/css" href="../../bower_components/jqPagination/css/jqpagination.css">
</head>

<body>

<div id="wrapper">

    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element">
                    </div>
                    <div class="logo-element">
                        IMedlib
                    </div>
                </li>
                <li>
                    <a href="#"><i class="fa fa-user"></i> <span class="nav-label">个人中心</span><span
                            class="fa arrow"></span></a>
                    <ul class="nav nav-second-level">
                        <li>
                            <a href="../../user/profile.html">个人信息</a>
                        </li>
                    </ul>
                </li>
                <li class="active">
                    <a href="#"><i class="fa fa-edit"></i> <span class="nav-label">资源中心</span> <span
                            class="fa arrow"></span></a>
                    <ul class="nav nav-second-level">
                        <li>
                            <a href="../list.html">我的资源</a>
                        </li>
                        <li>
                            <a href="#">云板书<span class="fa arrow"></span></a>
                            <ul class="nav nav-third-level">
                                <li>
                                    <a href="ybsupload.html">云板书上传</a>
                                </li>
                                <li class="active">
                                    <a href="list.html">我的云板书</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-book"></i> <span class="nav-label">课程课堂</span> <span
                            class="fa arrow"></span></a>
                    <!--<ul class="nav nav-second-level">-->
                    <!--<li>-->
                    <!--<a href="../../course/list.html">我的课程</a>-->
                    <!--</li>-->
                    <!--<li>-->
                    <!--<a href="../../class/list.html">我的课堂</a>-->
                    <!--</li>-->
                    <!--</ul>-->
                </li>
            </ul>

        </div>
    </nav>

    <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom">
            <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
                <!-- <div class="navbar-header">
                    <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
                    <form role="search" class="navbar-form-custom" method="post" action="#">
                        <div class="form-group">
                            <input type="text" placeholder="Search for something../..." class="form-control" name="top-search" id="top-search">
                        </div>
                    </form>
                </div> -->
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <strong class="font-bold" id="username"></strong>
                    </li>
                    <li>
                        <a href="#">
                            <i class="fa fa-sign-out"></i> 退出
                        </a>
                    </li>
                </ul>

            </nav>
        </div>
        <div class="wrapper wrapper-content animated fadeInRight">
            <div class="row">
                <div class="col-md-12">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <h4>
                                我的云板书
                            </h4>
                        </div>
                        <div class="ibox-content profile-content">
                            <div class="row">
                                <div id="ybs"></div>
                            </div>
                            <div class="pagination" id="ybsp">
                                <a href="#" class="first" data-action="first">&laquo;</a>
                                <a href="#" class="previous" data-action="previous">&lsaquo;</a>
                                <input title="" type="text" readonly="readonly"/>
                                <a href="#" class="next" data-action="next">&rsaquo;</a>
                                <a href="#" class="last" data-action="last">&raquo;</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="pull-right">

            </div>
            <div>
                <strong>Copyright</strong> IMedlib &copy; 2015
            </div>
        </div>
    </div>
</div>
<!-- Mainly scripts -->
<script src="../../bower_components/jquery/dist/jquery.min.js"></script>
<script src="../../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="../../bower_components/metisMenu/dist/metisMenu.min.js"></script>
<script src="../../bower_components/slimscroll/jquery.slimscroll.min.js"></script>
<script type="text/javascript" src="../../js/app.js"></script>
<script type="text/javascript" src="../../js/app.user.js"></script>
<script type="text/javascript" src="../../js/app.resource.js"></script>

<!-- Custom and plugin javascript -->
<script src="../../js/inspinia.js"></script>
<script src="../../bower_components/PACE/pace.min.js"></script>
<!--sweetalert-->
<script type="text/javascript" src="../../bower_components/sweetalert/dist/sweetalert.min.js"></script>
<script type="text/javascript" src="../../js/app-sweetalert.js"></script>
<script type="text/javascript" src="../../bower_components/jqPagination/js/jquery.jqpagination.min.js"></script>
<script type="text/javascript" src="../../bower_components/artTemplate/dist/template.js"></script>
<script id="listTemplate" type="text/html">
    {{each list}}
    <div class="col-lg-4">
        <div>
            <div class="col-sm-4">
                <div>
                    <img alt="image" class="m-t-xs img-responsive" src="{{$value.uri}}64_64.png">
                </div>
            </div>
            <div class="col-sm-8">
                <a target="_blank"
                   href="/yunbook.html?path={{$value.uri}}&id={{$value.id}}&w={{$value.width}}&h={{$value.height}}&z={{$value.zoom}}">
                    <h3><strong>{{$value.title}}</strong></h3></a>

                <p>{{$value.remark}}</p>
            </div>
            <div class="clearfix"><p>{{$value.itime}}</p></div>
        </div>
    </div>
    {{/each}}
</script>
<script>
    jQuery(document).ready(function ($) {
        var userid;
        var token;
        var limit = app.config.limit;
        init();
        function init() {
            getUserInfo();
            getList($('#ybs'), limit, 1);
        }

        function getUserInfo() {
            userid = app.cookie.get('userid');
            token = app.cookie.get('token');
            if (typeof userid == "undefined") {
                window.location.href = "../../login.html";
            }
            app.user.getUserInfo({
                data: {uid: userid},
                success: function (data) {
                    $('#username').text(data.uname || '');
                }
            });
        }

        function getCount() {
            var count = 0;
            app.resource.ybs.info({
                data: {uid: userid},
                success: function (data) {
                    if (typeof data.info.Count == "number")
                        count = data.info.Count;
                }
            });
            return count;
        }

        function getList(object, limit, offset) {
            app.resource.ybs.list({
                data: {
                    uid: userid,
                    limit: limit,
                    offset: offset
                },
                success: function (data) {
                    var html = template('listTemplate', data);
                    object.empty().append(html);
                }
            });

        }

        $('#ybsp').jqPagination({
            max_page: Math.ceil(getCount() / limit),
            page_string: '第{current_page}页,共{max_page}页',
            paged: function (page) {
                getList($('#ybs'), limit, page);
            }
        });

    });
</script>
</body>

</html>
